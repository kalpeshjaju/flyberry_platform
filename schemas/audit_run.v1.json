{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://flyberry/schemas/audit_run.v1.json",
  "title": "AuditRunV1",
  "type": "object",
  "required": ["run", "requested_checks", "blocks_used", "results"],
  "properties": {
    "run": {
      "type": "object",
      "required": ["id", "suite", "started_at", "schema_version"],
      "properties": {
        "id": {"type": "string"},
        "suite": {"type": "string"},
        "started_at": {"type": "string"},
        "schema_version": {"type": "string"}
      },
      "additionalProperties": true
    },
    "requested_checks": {"type": "array", "items": {"type": "string"}},
    "blocks_used": {"type": "array", "items": {"type": "string"}},
    "results": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["check_id", "block_id", "status"],
        "properties": {
          "check_id": {"type": "string"},
          "block_id": {"type": "string"},
          "status": {"type": "string", "enum": ["pass", "fail", "error"]},
          "metrics": {"type": "object"},
          "issues": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["id", "severity", "confidence", "rationale"],
              "properties": {
                "id": {"type": "string"},
                "severity": {"type": "string", "enum": ["critical", "major", "minor", "info"]},
                "confidence": {"type": "number"},
                "location": {
                  "type": "object",
                  "properties": {
                    "url": {"type": "string"},
                    "selector": {"type": "string"},
                    "viewport": {"type": "string"}
                  },
                  "additionalProperties": true
                },
                "evidence": {"type": "object"},
                "rationale": {"type": "string"},
                "suggested_fix": {"type": "string"},
                "meta": {"type": "object"}
              },
              "additionalProperties": true
            }
          }
        },
        "additionalProperties": true
      }
    },
    "meta": {"type": "object"}
  },
  "additionalProperties": true
}

